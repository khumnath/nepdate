<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Date Converter</title>
    <link href="https://fonts.googleapis.com/css2?family=Eczar:wght@400;500&display=swap" rel="stylesheet">
    <script type="text/javascript" src="bikram.js"></script>
    <script type="text/javascript" src="tithi.js"></script>
    <style>
        body, h1, h2, h3, label, input, select, button, div {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: Eczar, sans-serif;
        }

        .container {
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 100%;
            padding: 20px;
        }

        #title {
            font-size: 2em;
            margin-bottom: 20px;
            color: #343a40;
        }

        .language-toggle {
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 20px;
        }

        #languageLabel {
            margin-right: 10px;
        }

        .language-toggle select {
            width: auto;
            padding: 5px;
        }

        .btn-container {
            display: flex;
            align-items: center;
        }

        .btn-color-mode-switch {
            position: relative;
            width: 60px;
            height: 30px;
            margin: 0 10px;
            cursor: pointer;
        }

        .btn-color-mode-switch input {
            opacity: 0;
            width: 100%;
            height: 100%;
            position: absolute;
            cursor: pointer;
        }

        .slider {
            position: absolute;
            width: 100%;
            height: 100%;
            background-color: #007bff;
            border-radius: 15px;
            transition: background-color 0.4s;
        }

        .slider:before {
            content: '⇚';
            color: blue;
            position: absolute;
            width: 50%;
            height: 100%;
            background-color: #fff;
            border-radius: 15px;
            transition: transform 0.4s;
        }

        .btn-color-mode-switch input:checked + .slider:before {
            transform: translateX(100%);
            content: '⇛';
            color: blue;
        }

        .converter-container {
            display: none;
            flex-direction: column;
            align-items: center;
        }

        .converter-container.active {
            display: flex;
        }

        label {
            margin-top: 10px;
            margin-bottom: 5px;
            color: #343a40;
        }

        input[type="number"], select {
            padding: 10px;
            margin-bottom: 10px;
            width: 200px;
            border: 1px solid #ced4da;
            border-radius: 5px;
            transition: border-color 0.3s;
        }

        input[type="number"]:focus, select:focus {
            border-color: #007bff;
            outline: none;
        }

        button {
            padding: 10px 20px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin-top: 10px;
            transition: background-color 0.3s;
        }

        button:hover {
            background-color: #0056b3;
        }

        /* Results */
        h3 {
            margin-top: 20px;
            color: #000000;
        }
    </style>
</head>
<body>
<div class="container">
    <h1 id="title">Date Converter</h1>

    <div class="language-toggle">
        <label for="language" id="languageLabel">Select Language:</label>
        <select id="language" onchange="changeLanguage()">
            <option id="english" value="english">English</option>
            <option id="nepali" value="nepali">Nepali</option>
        </select>
    </div>

    <div class="btn-container">
        <div class="converter-title" id="convertToBikramTitle">Gregorian to Bikram Sambat</div>
        <label class="btn-color-mode-switch">
            <input type="checkbox" id="converterToggle" onclick="toggleConverter()">
            <div class="slider"></div>
        </label>
        <div class="converter-title" id="convertToGregorianTitle">Bikram Sambat to Gregorian</div>
    </div><br>

    <div class="converter-container active" id="gregorianToBikramContainer">
        <div class="form-group">
            <label for="gYear" id="gYearLabel">Year:</label>
            <input type="number" id="gYear" placeholder="YYYY" />
        </div>

        <div class="form-group">
            <label for="gMonth" id="gMonthLabel">Month:</label>
            <select id="gMonth"></select>
        </div>

        <div class="form-group">
            <label for="gDay" id="gDayLabel">Day:</label>
            <input type="number" id="gDay" placeholder="DD" />
        </div>
        
        <button onclick="convertToBikram()" id="convertToBikramButton">Convert to Bikram Sambat</button>
        
        <h3 id="bikramResult"></h3>
    </div>

    <div class="converter-container" id="bikramToGregorianContainer">
        <div class="form-group">
            <label for="bsYear" id="bsYearLabel">Year:</label>
            <input type="number" id="bsYear" placeholder="YYYY" />
        </div>

        <div class="form-group">
            <label for="bsMonth" id="bsMonthLabel">Month:</label>
            <select id="bsMonth"></select>
        </div>

        <div class="form-group">
            <label for="bsDay" id="bsDayLabel">Day:</label>
            <input type="number" id="bsDay" placeholder="DD" />
        </div>
        
        <button onclick="convertToGregorian()" id="convertToGregorianButton">Convert to Gregorian</button>
        
        <h3 id="gregorianResult"></h3>
    </div>
</div>
    <script>
function toggleConverter() {
    const gregorianToBikramContainer = document.getElementById('gregorianToBikramContainer');
    const bikramToGregorianContainer = document.getElementById('bikramToGregorianContainer');
    const converterToggle = document.getElementById('converterToggle');

    // Update the display of the containers based on the checked state
    if (converterToggle.checked) {
        gregorianToBikramContainer.classList.remove('active');
        bikramToGregorianContainer.classList.add('active');
    } else {
        gregorianToBikramContainer.classList.add('active');
        bikramToGregorianContainer.classList.remove('active');
    }
}

function populateDateDropdowns() {
    const today = new Date();
    const gYear = today.getFullYear();
    const gMonth = today.getMonth() + 1; // Months are 0-based, so add 1
    const gDay = today.getDate();

    // Populate Gregorian Year
    const yearSelect = document.getElementById("gYear");
    yearSelect.innerHTML = ""; // Clear existing options
    for (let year = gYear - 10; year <= gYear + 10; year++) {
        const option = document.createElement("option");
        option.value = year;
        option.textContent = year;
        yearSelect.appendChild(option);
    }
    yearSelect.value = gYear; // Set today's year

    // Populate Gregorian Month
    const monthSelect = document.getElementById("gMonth");
    monthSelect.innerHTML = ""; // Clear existing options
    translations[currentLanguage].gMonths.forEach((month, index) => {
        const option = document.createElement("option");
        option.value = index + 1; // Month value starts from 1
        option.textContent = month; // Use month names
        monthSelect.appendChild(option);
    });
    monthSelect.value = gMonth; // Set today's month (1-based)

    // Populate Gregorian Day
    const daySelect = document.getElementById("gDay");
    daySelect.innerHTML = ""; // Clear existing options
    const daysInMonth = new Date(gYear, gMonth, 0).getDate(); // Get the number of days in the month
    for (let day = 1; day <= daysInMonth; day++) {
        const option = document.createElement("option");
        option.value = day;
        option.textContent = day;
        daySelect.appendChild(option);
    }
    daySelect.value = gDay; // Set today's day

    // Convert today's Gregorian date to Bikram Sambat
    const bikram = new Bikram();
    bikram.fromGregorian(gYear, gMonth, gDay);
    const bsYear = bikram.getYear();
    const bsMonth = bikram.getMonth();
    const bsDay = bikram.getDay();

    // Populate Bikram Sambat Year
    const bsYearSelect = document.getElementById("bsYear");
    bsYearSelect.innerHTML = ""; // Clear existing options
    for (let year = bsYear - 10; year <= bsYear + 10; year++) {
        const option = document.createElement("option");
        option.value = year;
        option.textContent = year;
        bsYearSelect.appendChild(option);
    }
    bsYearSelect.value = bsYear; // Set today's Bikram Sambat year

    // Populate Bikram Sambat Month
    const bsMonthSelect = document.getElementById("bsMonth");
    bsMonthSelect.innerHTML = ""; // Clear existing options
    translations[currentLanguage].bsMonths.forEach((month, index) => {
        const option = document.createElement("option");
        option.value = index + 1; // Month value starts from 1
        option.textContent = month; // Use month names
        bsMonthSelect.appendChild(option);
    });
    bsMonthSelect.value = bsMonth; // Set today's Bikram Sambat month

    // Populate Bikram Sambat Day
    const bsDaySelect = document.getElementById("bsDay");
    bsDaySelect.innerHTML = ""; // Clear existing options
    const bsDaysInMonth = new Bikram().daysInMonth(bsYear, bsMonth); // Get the number of days in the Bikram Sambat month
    for (let day = 1; day <= bsDaysInMonth; day++) {
        const option = document.createElement("option");
        option.value = day;
        option.textContent = day;
        bsDaySelect.appendChild(option);
    }
    bsDaySelect.value = bsDay; // Set today's Bikram Sambat day
}

        const translations = {
            english: {
                title: "Date Converter",
                english: "English",
                nepali: "Nepali",
                languageLabel: "Select Language:",
                convertToBikramTitle: "Convert to Bikram Sambat",
                gYearLabel: "Year:",
                gMonthLabel: "Month:",
                gDayLabel: "Day:",
                convertToBikramButton: "Convert to Bikram Sambat",
                convertToGregorianTitle: "Convert to Gregorian",
                bsYearLabel: "Year:",
                bsMonthLabel: "Month:",
                bsDayLabel: "Day:",
                convertToGregorianButton: "Convert to Gregorian",
                gMonths: ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"],
                bsMonths: ["Baisakh", "Jestha", "Ashadh", "Shrawan", "Bhadra", "Ashwin", "Kartik", "Mangsir", "Poush", "Magh", "Falgun", "Chaitra"]
            },
            nepali: {
                title: "मिति रूपान्तरण",
                english: "अङ्ग्रेजी",
                nepali: "नेपाली",
                languageLabel: "भाषा चयन गर्नुहोस्:",
                convertToBikramTitle: "विक्रम सम्बतमा रूपान्तरण",
                gYearLabel: "वर्ष:",
                gMonthLabel: "महिना:",
                gDayLabel: "दिन:",
                convertToBikramButton: "विक्रम सम्बतमा रूपान्तरण गर्नुहोस्",
                convertToGregorianTitle: "इसवि सनमा रूपान्तरण",
                bsYearLabel: "वर्ष:",
                bsMonthLabel: "महिना:",
                bsDayLabel: "दिन:",
                convertToGregorianButton: "इसवि सनमा रूपान्तरण गर्नुहोस्",
                gMonths: ["जनवरी", "फेब्रुअरी", "मार्च", "अप्रिल", "मे", "जुन", "जुलाई", "अगस्ट", "सेप्टेम्बर", "अक्टोबर", "नोभेम्बर", "डिसेम्बर"],
                bsMonths: ["बैसाख", "जेष्ठ", "आषाढ", "श्रावण", "भाद्र", "आश्विन", "कार्तिक", "मंसिर", "पौष", "माघ", "फागुन", "चैत"]
            }
        };
     
       let currentLanguage = 'nepali'; // Set initial language to Nepali

        function changeLanguage() {
            currentLanguage = document.getElementById("language").value; // Update the existing variable
            const lang = translations[currentLanguage];

            document.getElementById("title").innerText = lang.title;
            document.getElementById("nepali").innerText = lang.nepali;
            document.getElementById("english").innerText = lang.english;
            document.getElementById("languageLabel").innerText = lang.languageLabel;
            document.getElementById("convertToBikramTitle").innerText = lang.convertToBikramTitle;
            document.getElementById("gYearLabel").innerText = lang.gYearLabel;
            document.getElementById("gMonthLabel").innerText = lang.gMonthLabel;
            document.getElementById("gDayLabel").innerText = lang.gDayLabel;
            document.getElementById("convertToBikramButton").innerText = lang.convertToBikramButton;
            document.getElementById("convertToGregorianTitle").innerText = lang.convertToGregorianTitle;
            document.getElementById("bsYearLabel").innerText = lang.bsYearLabel;
            document.getElementById("bsMonthLabel").innerText = lang.bsMonthLabel;
            document.getElementById("bsDayLabel").innerText = lang.bsDayLabel;
            document.getElementById("convertToGregorianButton").innerText = lang.convertToGregorianButton;

            // Update dropdown items
            updateDropdowns(lang.gMonths, lang.bsMonths);
            populateDateDropdowns();

            // Clear results when language changes
            document.getElementById("bikramResult").innerText = "";
            document.getElementById("gregorianResult").innerText = "";
        }





        function updateDropdowns(gMonths, bsMonths) {
            const gMonthSelect = document.getElementById("gMonth");
            const bsMonthSelect = document.getElementById("bsMonth");

            // Clear existing options
            gMonthSelect.innerHTML = '';
            bsMonthSelect.innerHTML = '';

            // Populate Gregorian months
            gMonths.forEach((month, index) => {
                const option = document.createElement("option");
                option.value = index + 1; // Month value starts from 1
                option.text = month;
                gMonthSelect.appendChild(option);
            });

            // Populate Bikram Sambat months
            bsMonths.forEach((month, index) => {
                const option = document.createElement("option");
                option.value = index + 1; // Month value starts from 1
                option.text = month;
                bsMonthSelect.appendChild(option);
            });
        }

        // Call changeLanguage on page load to set initial language to Nepali
        window.onload = function() {
    document.getElementById("language").value = "nepali"; // Set default language to Nepali
    changeLanguage(); // Update the interface to Nepali
    populateDateDropdowns(); // Call the function to populate the dropdowns with current date on page load
};
      
       function convertToBikram() {
    const gYear = parseInt(document.getElementById("gYear").value);
    const gMonth = document.getElementById("gMonth").selectedIndex + 1; // Get the selected index and convert to 1-based month
    const gDay = parseInt(document.getElementById("gDay").value);

    const bikram = new Bikram();
    bikram.fromGregorian(gYear, gMonth, gDay);
    const bikramYear = bikram.getYear();
    const bikramMonth = bikram.getMonth(); // Get the month index (1-12)
    const bikramMonthName = bikram.getMonthName(bikramMonth); // Get the month name
    const bikramDay = bikram.getDay();
    const weekdayName = bikram.getWeekdayName(gYear, gMonth, gDay);
    
    // Calculate Tithi using the original Gregorian date
    const tithiInfo = calculateTithi(gYear, gMonth, gDay); // Use Gregorian date for Tithi calculation
    const tithiDisplay = tithiInfo.tithi;
    const pakshaDisplay = tithiInfo.paksha;

    // Display the result
    document.getElementById("bikramResult").innerText = `${bikramYear} ${bikramMonthName} ${bikramDay} ${weekdayName} (${pakshaDisplay}, ${tithiDisplay})`;
}
        function convertToGregorian() {
    const bsYear = parseInt(document.getElementById("bsYear").value);
    const bsMonth = parseInt(document.getElementById("bsMonth").value);
    const bsDay = parseInt(document.getElementById("bsDay").value);

    const bikram = new Bikram();
    bikram.fromNepali(bsYear, bsMonth, bsDay);
    const gYear = bikram.getYear();
    const gMonth = bikram.getMonth(); // Get the month number (1-based)
    const gDay = bikram.getDay();
    
    // Get the correct month name for the Gregorian date
    const language = document.getElementById("language").value;
    const gMonthName = language === "nepali" ? 
        translations.nepali.gMonths[gMonth - 1] : 
        translations.english.gMonths[gMonth - 1];

    const weekdayName = bikram.getWeekdayName(gYear, gMonth, gDay);
    document.getElementById("gregorianResult").innerText = ` ${gYear} ${gMonthName} ${gDay} ${weekdayName}`;
}

    </script>
</body>
</html>